require('../../../../common/runtime.js');require('../../../../common/vendor.js');require('../../../../common/main.js');(global["webpackJsonp_123"]=global["webpackJsonp_123"]||[]).push([["uni_modules/qiun-data-charts/components/qiun-data-charts/qiun-data-charts"],{"5daa":function(t,e,i){"use strict";var a=i("8951"),o=i.n(a);o.a},"684d":function(t,e,i){"use strict";i.r(e);var a=i("a14d"),o=i("9c0e");for(var n in o)"default"!==n&&function(t){i.d(e,t,(function(){return o[t]}))}(n);i("5daa");var s,r=i("f0c5"),c=Object(r["a"])(o["default"],a["b"],a["c"],!1,null,"b72d99b8",null,!1,a["a"],s);e["default"]=c.exports},8951:function(t,e,i){},"9c0e":function(t,e,i){"use strict";i.r(e);var a=i("9dd8"),o=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,(function(){return a[t]}))}(n);e["default"]=o.a},"9dd8":function(t,e,i){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(i("1369")),n=s(i("2f90"));function s(t){return t&&t.__esModule?t:{default:t}}function r(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length,i=new Array(e>1?e-1:0),a=1;a<e;a++)i[a-1]=arguments[a];for(var o in i)for(var n in i[o])i[o].hasOwnProperty(n)&&(t[n]=i[o][n]&&"object"===typeof i[o][n]?r(Array.isArray(i[o][n])?[]:{},t[n],i[o][n]):i[o][n]);return t}function c(t,e){for(var i in t)"object"===typeof t[i]?c(t[i],e):"format"===i&&"string"===typeof t[i]&&(t["formatter"]=e[t[i]]?e[t[i]]:void 0);return t}function l(t){var e="-",i=t.getFullYear(),a=t.getMonth()+1,o=t.getDate();a>=1&&a<=9&&(a="0"+a),o>=0&&o<=9&&(o="0"+o);var n=i+e+a+e+o;return n}var h=null,u={name:"qiun-data-charts",mixins:[t.mixinDatacom],props:{type:{type:String,default:null},canvasId:{type:String,default:"uchartsid"},canvas2d:{type:Boolean,default:!1},background:{type:String,default:"none"},animation:{type:Boolean,default:!0},chartData:{type:Object,default:function(){return{categories:[],series:[]}}},opts:{type:Object,default:function(){return{}}},eopts:{type:Object,default:function(){return{}}},loadingType:{type:Number,default:2},errorShow:{type:Boolean,default:!0},errorMessage:{type:String,default:null},inScrollView:{type:Boolean,default:!1},reshow:{type:Boolean,default:!1},reload:{type:Boolean,default:!1},disableScroll:{type:Boolean,default:!1},ontap:{type:Boolean,default:!0},ontouch:{type:Boolean,default:!1},onmouse:{type:Boolean,default:!0},onmovetip:{type:Boolean,default:!1},tooltipShow:{type:Boolean,default:!0},tooltipFormat:{type:String,default:void 0},tooltipCustom:{default:void 0},startDate:{type:String,default:void 0},endDate:{type:String,default:void 0},textEnum:{type:Array,default:function(){return[]}},groupEnum:{type:Array,default:function(){return[]}},pageScrollTop:{type:Number,default:0}},data:function(){return{cid:"uchartsid",inWx:!1,inAli:!1,inTt:!1,inBd:!1,inH5:!1,inApp:!1,type2d:!0,disScroll:!1,pixel:1,cWidth:375,cHeight:250,showchart:!1,echarts:!1,echartsResize:!1,uchartsOpts:{},echartsOpts:{},drawData:{},lastDrawTime:null}},created:function(){if(this.cid=this.canvasId,"uchartsid"==this.canvasId||""==this.canvasId){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=t.length,i="",o=0;o<32;o++)i+=t.charAt(Math.floor(Math.random()*e));this.cid=i}this.inWx=!0,!1===this.canvas2d?this.type2d=!1:(this.pixel=a.getSystemInfoSync().pixelRatio,"uchartsid"!==this.canvasId&&""!=this.canvasId||console.log("[uCharts]:开启canvas2d模式，必须指定canvasId，否则会出现偶尔获取不到dom节点的问题！")),this.disScroll=this.disableScroll},mounted:function(){var t=this;this.$nextTick((function(){t.beforeInit()})),a.onWindowResize((function(e){if(1!=t.mixinDatacomLoading){var i=t.mixinDatacomErrorMessage;null!==i&&"null"!==i&&""!==i||setTimeout((function(){t.echarts?t.echartsResize=!t.echartsResize:t.resizeHandler()}),200)}}))},destroyed:function(){!0===this.echarts?(delete cfe.option[this.cid],delete cfe.instance[this.cid]):(delete n.default.option[this.cid],delete n.default.instance[this.cid]),a.offWindowResize((function(){}))},watch:{chartDataProps:{handler:function(t,e){"object"===typeof t?JSON.stringify(t)!==JSON.stringify(e)&&(t.series&&t.series.length>0?this.beforeInit():(this.mixinDatacomLoading=!0,this.showchart=!1,this.mixinDatacomErrorMessage=null)):(this.mixinDatacomLoading=!1,this.showchart=!1,this.mixinDatacomErrorMessage="参数错误：chartData数据类型错误")},immediate:!1,deep:!0},localdata:{handler:function(t,e){JSON.stringify(t)!==JSON.stringify(e)&&(t.length>0?this.beforeInit():(this.mixinDatacomLoading=!0,this.showchart=!1,this.mixinDatacomErrorMessage=null))},immediate:!1,deep:!0},optsProps:{handler:function(t,e){"object"===typeof t?JSON.stringify(t)!==JSON.stringify(e)&&!1===this.echarts&&this.checkData(this.drawData):(this.mixinDatacomLoading=!1,this.showchart=!1,this.mixinDatacomErrorMessage="参数错误：opts数据类型错误")},immediate:!1,deep:!0},eoptsProps:{handler:function(t,e){"object"===typeof t?JSON.stringify(t)!==JSON.stringify(e)&&!0===this.echarts&&this.checkData(this.drawData):(this.mixinDatacomLoading=!1,this.showchart=!1,this.mixinDatacomErrorMessage="参数错误：eopts数据类型错误")},immediate:!1,deep:!0},reshow:function(t,e){var i=this;!0===t&&!1===this.mixinDatacomLoading&&setTimeout((function(){i.showchart=!0,i.mixinDatacomErrorMessage=null,i.echartsResize=!i.echartsResize,i.checkData(i.drawData)}),200)},reload:function(t,e){!0===t&&(this.showchart=!1,this.mixinDatacomErrorMessage=null,this.reloading())},mixinDatacomErrorMessage:function(t,e){t&&(this.emitMsg({name:"error",params:{type:"error",errorShow:this.errorShow,msg:t,id:this.cid}}),this.errorShow&&console.log("[秋云图表组件]"+t))},errorMessage:function(t,e){t&&this.errorShow&&null!==t&&"null"!==t&&""!==t?(this.showchart=!1,this.mixinDatacomLoading=!1,this.mixinDatacomErrorMessage=t):(this.showchart=!1,this.mixinDatacomErrorMessage=null,this.reloading())}},computed:{optsProps:function(){return JSON.parse(JSON.stringify(this.opts))},eoptsProps:function(){return JSON.parse(JSON.stringify(this.eopts))},chartDataProps:function(){return JSON.parse(JSON.stringify(this.chartData))}},methods:{beforeInit:function(){this.mixinDatacomErrorMessage=null,"object"===typeof this.chartData&&null!=this.chartData&&void 0!==this.chartData.series&&this.chartData.series.length>0?(this.mixinDatacomLoading=!0,this.drawData=r({},this.chartData),this.checkData(this.chartData)):this.localdata.length>0?(this.mixinDatacomLoading=!0,this.localdataInit(this.localdata)):""!==this.collection?(this.mixinDatacomLoading=!1,this.getCloudData()):this.mixinDatacomLoading=!0},localdataInit:function(t){if(this.groupEnum.length>0)for(var e=0;e<t.length;e++)for(var i=0;i<this.groupEnum.length;i++)t[e].group===this.groupEnum[i].value&&(t[e].group=this.groupEnum[i].text);if(this.textEnum.length>0)for(var a=0;a<t.length;a++)for(var o=0;o<this.textEnum.length;o++)t[a].text===this.textEnum[o].value&&(t[a].text=this.textEnum[o].text);var s=!1,c={categories:[],series:[]},h=[],u=[];if(s=!0===this.echarts?cfe.categories.includes(this.type):n.default.categories.includes(this.type),!0===s){if(this.chartData&&this.chartData.categories&&this.chartData.categories.length>0)h=this.chartData.categories;else if(this.startDate&&this.endDate){var d=new Date(this.startDate),f=new Date(this.endDate);while(d<=f)h.push(l(d)),d=d.setDate(d.getDate()+1),d=new Date(d)}else{var p={};t.map((function(t,e){void 0==t.text||p[t.text]||(h.push(t.text),p[t.text]=!0)}))}c.categories=h}var m={};if(t.map((function(t,e){void 0==t.group||m[t.group]||(u.push({name:t.group,data:[]}),m[t.group]=!0)})),0==u.length)if(u=[{name:"默认分组",data:[]}],!0===s)for(var g=0;g<h.length;g++){for(var x=0,v=0;v<t.length;v++)t[v].text==h[g]&&(x=t[v].value);u[0].data.push(x)}else for(var D=0;D<t.length;D++)u[0].data.push({name:t[D].text,value:t[D].value});else for(var y=0;y<u.length;y++)if(h.length>0)for(var w=0;w<h.length;w++){for(var S=0,T=0;T<t.length;T++)u[y].name==t[T].group&&t[T].text==h[w]&&(S=t[T].value);u[y].data.push(S)}else for(var b=0;b<t.length;b++)u[y].name==t[b].group&&u[y].data.push(t[b].value);c.series=u,this.drawData=r({},c),this.checkData(c)},reloading:function(){this.showchart=!1,this.mixinDatacomErrorMessage=null,""!==this.collection?(this.mixinDatacomLoading=!1,this.onMixinDatacomPropsChange(!0)):this.beforeInit()},checkData:function(t){var e=this.cid;!0===this.echarts?(this.type&&cfe.type.includes(this.type)?cfe.option[e]=r({},cfe[this.type],this.eopts):cfe.option[e]=r({},this.eopts),cfe.option[e].id=e):this.type&&n.default.type.includes(this.type)?(n.default.option[e]=r({},n.default[this.type],this.opts),n.default.option[e].canvasId=e):(this.mixinDatacomLoading=!1,this.showchart=!1,this.mixinDatacomErrorMessage="参数错误：props参数中type类型不正确");var i=r({},t);if(void 0!==i.series&&i.series.length>0)if(this.mixinDatacomErrorMessage=null,!0===this.echarts){cfe.option[e].xAxis&&cfe.option[e].xAxis.type&&"category"===cfe.option[e].xAxis.type&&(cfe.option[e].xAxis.data=i.categories),cfe.option[e].yAxis&&cfe.option[e].yAxis.type&&"category"===cfe.option[e].yAxis.type&&(cfe.option[e].yAxis.data=i.categories),cfe.option[e].series=[];for(var a=0;a<i.series.length;a++){cfe.option[e].seriesTemplate=cfe.option[e].seriesTemplate?cfe.option[e].seriesTemplate:{};var o=r({},cfe.option[e].seriesTemplate,i.series[a]);cfe.option[e].series.push(o)}this.init()}else n.default.option[e].categories=i.categories,n.default.option[e].series=i.series,this.init()},resizeHandler:function(){var t=this,e=Date.now(),i=this.lastDrawTime?this.lastDrawTime:e-3e3,o=e-i;if(!(o<1e3))a.createSelectorQuery().in(this).select(".chartsview").boundingClientRect((function(e){t.showchart=!0,e.width>0&&e.height>0&&(e.width===t.cWidth&&e.height===t.cHeight||t.checkData(t.drawData))})).exec()},getCloudData:function(){var t=this;1!=this.mixinDatacomLoading&&(this.mixinDatacomLoading=!0,this.mixinDatacomGet().then((function(e){t.mixinDatacomResData=e.result.data,t.localdataInit(t.mixinDatacomResData)})).catch((function(e){t.mixinDatacomLoading=!1,t.showchart=!1,t.mixinDatacomErrorMessage="请求错误："+e})))},onMixinDatacomPropsChange:function(t,e){1==t&&""!==this.collection&&(this.showchart=!1,this.mixinDatacomErrorMessage=null,this._clearChart(),this.getCloudData())},_clearChart:function(){var t=this.cid;if(!0!==this.echrts){var e=a.createCanvasContext(t,this);e.clearRect(0,0,this.cWidth,this.cHeight),e.draw()}},init:function(){var t=this,e=this.cid;a.createSelectorQuery().in(this).select(".chartsview").boundingClientRect((function(i){i.width>0&&i.height>0?(t.lastDrawTime=Date.now(),t.cWidth=i.width,t.cHeight=i.height,!0!==t.echarts&&(n.default.option[e].background="none"==t.background?"#FFFFFF":t.background,n.default.option[e].canvas2d=t.type2d,n.default.option[e].pixelRatio=t.pixel,n.default.option[e].animation=t.animation,n.default.option[e].width=i.width*t.pixel,n.default.option[e].height=i.height*t.pixel,n.default.option[e].ontap=t.ontap,n.default.option[e].ontouch=t.ontouch,n.default.option[e].onmouse=t.onmouse,n.default.option[e].onmovetip=t.onmovetip,n.default.option[e].tooltipShow=t.tooltipShow,n.default.option[e].tooltipFormat=t.tooltipFormat,n.default.option[e].tooltipCustom=t.tooltipCustom,n.default.option[e].inScrollView=t.inScrollView,n.default.option[e].lastDrawTime=t.lastDrawTime),t.inH5||t.inApp?1==t.echarts?(t.mixinDatacomLoading=!1,t.showchart=!0,cfe.option[e].ontap=t.ontap,cfe.option[e].onmouse=t.onmouse,cfe.option[e].tooltipShow=t.tooltipShow,cfe.option[e].tooltipFormat=t.tooltipFormat,cfe.option[e].tooltipCustom=t.tooltipCustom,cfe.option[e].lastDrawTime=t.lastDrawTime,cfe.option[e].rotateLock=cfe.option[e].rotate,t.echartsOpts=r({},cfe.option[e])):(n.default.option[e].rotateLock=n.default.option[e].rotate,t.mixinDatacomLoading=!1,t.showchart=!0,t.uchartsOpts=r({},n.default.option[e])):(n.default.option[e]=c(n.default.option[e],n.default.formatter),t.mixinDatacomErrorMessage=null,t.mixinDatacomLoading=!1,t.showchart=!0,t.$nextTick((function(){if(!0===t.type2d){var o=a.createSelectorQuery().in(t);o.select("#"+e).fields({node:!0,size:!0}).exec((function(a){if(a[0]){var o=a[0].node,s=o.getContext("2d");n.default.option[e].context=s,o.width=i.width*t.pixel,o.height=i.height*t.pixel,o._width=i.width*t.pixel,o._height=i.height*t.pixel,n.default.option[e].rotateLock=n.default.option[e].rotate,t._newChart(e)}else t.showchart=!1,t.mixinDatacomErrorMessage="参数错误：开启2d模式后，未获取到dom节点，canvas-id:"+e}))}else(t.inAli||t.inBd)&&(n.default.option[e].rotateLock=n.default.option[e].rotate),n.default.option[e].context=a.createCanvasContext(e,t),t._newChart(e)})))):(t.mixinDatacomLoading=!1,t.showchart=!1,1==t.reshow&&(t.mixinDatacomErrorMessage="布局错误：未获取到父元素宽高尺寸！canvas-id:"+e))})).exec()},saveImage:function(){a.canvasToTempFilePath({canvasId:this.cid,success:function(t){a.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:function(){a.showToast({title:"保存成功",duration:2e3})}})}},this)},_newChart:function(t){var e=this;1!=this.mixinDatacomLoading&&(this.showchart=!0,n.default.instance[t]=new o.default(n.default.option[t]),n.default.instance[t].addEventListener("renderComplete",(function(){e.emitMsg({name:"complete",params:{type:"complete",complete:!0,id:t}}),n.default.instance[t].delEventListener("renderComplete")})),n.default.instance[t].addEventListener("scrollLeft",(function(){e.emitMsg({name:"scrollLeft",params:{type:"scrollLeft",scrollLeft:!0,id:t}})})),n.default.instance[t].addEventListener("scrollRight",(function(){e.emitMsg({name:"scrollRight",params:{type:"scrollRight",scrollRight:!0,id:t}})})))},_tooltipDefault:function(t,e,i,a){if(e){var o=t.data;return"object"===typeof t.data&&(o=t.data.value),e+" "+t.name+":"+o}return void 0!==t.properties?t.properties.name:t.name+":"+t.data},_showTooltip:function(t){var e=this,i=this.cid,a=n.default.option[i].tooltipCustom;if(a&&void 0!==a&&null!==a){var o=void 0;a.x>=0&&a.y>=0&&(o={x:a.x,y:a.y+10}),n.default.instance[i].showToolTip(t,{index:a.index,offset:o,textList:a.textList,formatter:function(t,a,o,s){return"string"===typeof n.default.option[i].tooltipFormat&&n.default.formatter[n.default.option[i].tooltipFormat]?n.default.formatter[n.default.option[i].tooltipFormat](t,a,o,s):e._tooltipDefault(t,a,o,s)}})}else n.default.instance[i].showToolTip(t,{formatter:function(t,a,o,s){return"string"===typeof n.default.option[i].tooltipFormat&&n.default.formatter[n.default.option[i].tooltipFormat]?n.default.formatter[n.default.option[i].tooltipFormat](t,a,o,s):e._tooltipDefault(t,a,o,s)}})},_tap:function(t,e){var i=this,o=this.cid,s=null,r=null;if(!0===this.inScrollView||this.inAli)a.createSelectorQuery().in(this).select(".chartsview").boundingClientRect((function(a){t.changedTouches=[],i.inAli?t.changedTouches.unshift({x:t.detail.pageX-a.left,y:t.detail.pageY-a.top}):t.changedTouches.unshift({x:t.detail.x-a.left,y:t.detail.y-a.top-i.pageScrollTop}),e?!0===i.tooltipShow&&i._showTooltip(t):(s=n.default.instance[o].getCurrentDataIndex(t),r=n.default.instance[o].getLegendDataIndex(t),n.default.instance[o].touchLegend(t),!0===i.tooltipShow&&i._showTooltip(t),i.emitMsg({name:"getIndex",params:{type:"getIndex",event:{x:t.detail.x-a.left,y:t.detail.y-a.top},currentIndex:s,legendIndex:r,id:o}}))})).exec();else e?!0===this.tooltipShow&&this._showTooltip(t):(t.changedTouches=[],t.changedTouches.unshift({x:t.detail.x-t.currentTarget.offsetLeft,y:t.detail.y-t.currentTarget.offsetTop}),s=n.default.instance[o].getCurrentDataIndex(t),r=n.default.instance[o].getLegendDataIndex(t),n.default.instance[o].touchLegend(t),!0===this.tooltipShow&&this._showTooltip(t),this.emitMsg({name:"getIndex",params:{type:"getIndex",event:{x:t.detail.x,y:t.detail.y-t.currentTarget.offsetTop},currentIndex:s,legendIndex:r,id:o}}))},_touchStart:function(t){var e=this.cid;h=Date.now(),!0===n.default.option[e].enableScroll&&(n.default.instance[e].scrollStart(t),this.emitMsg({name:"getTouchStart",params:{type:"touchStart",event:t.changedTouches[0],id:e}}))},_touchMove:function(t){var e=this.cid,i=Date.now(),a=i-h;a<Math.floor(1e3/60)||(h=i,!0===n.default.option[e].enableScroll&&(n.default.instance[e].scroll(t),this.emitMsg({name:"getTouchMove",params:{type:"touchMove",event:t.changedTouches[0],id:e}})),!0===this.ontap&&!1===n.default.option[e].enableScroll&&!0===this.onmovetip&&this._tap(t,!0))},_touchEnd:function(t){var e=this.cid;!0===n.default.option[e].enableScroll&&(n.default.instance[e].scrollEnd(t),this.emitMsg({name:"getTouchEnd",params:{type:"touchEnd",event:t.changedTouches[0],id:e}})),!0===this.ontap&&!1===n.default.option[e].enableScroll&&!0===this.onmovetip&&this._tap(t,!0)},_error:function(t){this.mixinDatacomErrorMessage=t.detail.errMsg},emitMsg:function(t){this.$emit(t.name,t.params)},getRenderType:function(){!0===this.echarts&&!1===this.mixinDatacomLoading&&this.beforeInit()},toJSON:function(){return this}}};e.default=u}).call(this,i("a9ff")["default"],i("543d")["default"])},a14d:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return a}));var a={qiunLoading:function(){return i.e("uni_modules/qiun-data-charts/components/qiun-loading/qiun-loading").then(i.bind(null,"a620"))},qiunError:function(){return i.e("uni_modules/qiun-data-charts/components/qiun-error/qiun-error").then(i.bind(null,"e34c"))}},o=function(){var t=this,e=t.$createElement;t._self._c},n=[]}}]);
;(global["webpackJsonp_123"] = global["webpackJsonp_123"] || []).push([
    'uni_modules/qiun-data-charts/components/qiun-data-charts/qiun-data-charts-create-component',
    {
        'uni_modules/qiun-data-charts/components/qiun-data-charts/qiun-data-charts-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("684d"))
        })
    },
    [['uni_modules/qiun-data-charts/components/qiun-data-charts/qiun-data-charts-create-component']]
]);
